<!DOCTYPE html>
<html>
<head>
  <title>PDX API</title>
  <script type="text/javascript" src="http://www.google.com/jsapi?key=ABQIAAAAUXDSXET8IRGdgHP9FpGw5BT-fVzUWGS_eJ2ZLPBO_6yPqTi0vhQKAzahOrduDq0xQk09GR-UP3Jgcg"></script>
  <script type="text/javascript">
    google.load("jquery", '1.3');
    google.load("maps", "2.x");
  </script>
  <script type="text/javascript" charset="utf-8" src="pdxapi.js"></script>
  <link rel="stylesheet" href="http://jashkenas.github.com/docco/resources/docco.css">
  <style type="text/css">
    #map {
      width: 100%;
      height: 300px; }
      
    .map_button {
      z-index: 666;
      background-color: #FFF;
      border: 1px solid #000;
      position: absolute;
      padding: 0px 5px;
      top: 5px;
      right: 5px;
      cursor:hand;
      cursor:pointer;
    }
    .map_button:active{
      top: 6px;
    }
    #dataset {
      position: absolute;
      top: 9px;
      right: 110px;
    }
    
  </style>
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <table cellspacing=0 cellpadding=0>
  <thead>
    <div id="map"></div>
    <select id="dataset">
      <option value='bicycle_parking'      >bicycle parking</option>
      <option value='fire_stations_region' >fire stations</option>
      <option value='city_halls_region'    >city halls</option>
      <option value='hospitals_region'     >hospitals</option>
      <option value='light_rail_stops'     >light rail stops</option>
      <option value='schools_region'       >schools</option>
      <option value='libraries_region'     >libraries</option>
    </select>
    <div id="fullscreen" class="map_button">view larger</div>
    <tr>
      <th class=docs><h1>PDX API</h1></th>
      <td class=code>
        <code><i>Drag the map around to explore bike rack locations</i></code>
      </td>
    </tr>
  </thead>
  <tbody>
    <tr id='section-1'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-1">#</a>
        </div>
        <p><strong>UPDATE 5/13/10: PDXAPI is being migrated to a new version of GeoCouch and the API may be unavailable. This project is still very much a work in progress! Follow my tweeters if you want to stay up to date: <a href='http://www.twitter.com/maxogden'>@maxogden</a></strong></p>
        <p> <strong>PDXAPI</strong> is a JSON API that provides access to data from <a href="http://www.civicapps.org">CivicApps</a>,
         the open data initiative by the City of Portland.</p>
        <p> Much of the data on CivicApps is in a very raw and hard to use form.
         PDX API exists to filter the data from CivicApps and provide it in the
         easiest way possible to application developers wanting to consume the data.</p>
        <p> Currently the API supports a basic geolocation based query on a small
         number of datasets. As more data sets get imported from CivicApps,
         the API will become more useful.</p>
      </td>
      <td class=code>
        <h3>Example</h3>
        <p> <strong>JQuery</strong> JSONP request to the <code>bike_racks</code> resource (bicycle lock rack locations):</p>
        <div class='highlight'><pre>
        <span class="nx">$</span><span class="p">.</span><span class="nx">ajax</span><span class="p">({</span>
          <span class="nx">url</span><span class="o">:</span> <span class="s2">&quot;http://www.pdxapi.com/bike_racks&quot;</span><span class="o">,</span>
          <span class="nx">dataType</span><span class="o">:</span> <span class="s1">&#39;jsonp&#39;</span><span class="o">,</span>
          <span class="nx">data</span><span class="o">:</span> <span class="p">{</span>
            <span class="s2">&quot;lat&quot;</span><span class="o">:</span><span class="mf">45.5234515</span><span class="o">,</span>
            <span class="s2">&quot;lon&quot;</span><span class="o">:-</span><span class="mf">122.6762071</span><span class="o">,</span>
            <span class="s2">&quot;count&quot;</span><span class="o">:</span><span class="mi">2</span>
          <span class="p">}</span><span class="o">,</span>
          <span class="nx">success</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">){</span>
            <span class="c">// manipulate data</span>
          <span class="p">}</span>
        <span class="p">});</span>
        </pre></div>
      </td>
    </tr>
    <tr id='section-2'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-2">#</a>
        <h3>API</h3>
        <p> <strong>pdxapi.com/</strong><code>resource</code><strong>?</strong><code>lat</code><strong>=latitude&amp;</strong><code>lon</code><strong>=longitude</strong></p>
        <p> You must specify the <code>resource</code> (dataset) and supply a <code>lat</code>/<code>lon</code> pair.
         The <code>lat</code>/<code>lon</code> pair represents the point in space that you are querying.</p>
        <p> You may include an optional <code>count</code> parameter to specify the number
         of results you want to be returned from the resource.</p>
        <p> You&rsquo;ll need to request the data using library that supports <a href="http://en.wikipedia.org/wiki/JSON#JSONP">JSONP</a>,
         such as <a href="http://api.jquery.com/jQuery.getJSON/">jQuery</a>.</p>
         </div>
      </td>
      <td class=code>
        <p> The JSON data that gets returned looks like this:</p>
        <div class="highlight">
        <pre>
          <span class="p">[</span>
           <span class="p">{</span><span class="s2">&quot;distance&quot;</span><span class="o">:</span><span class="mf">35.054530</span><span class="o">,</span><span class="s2">&quot;lat&quot;</span><span class="o">:</span><span class="mf">45.523392</span><span class="o">,</span><span class="s2">&quot;lon&quot;</span><span class="o">:</span><span class="mf">-122.676315</span><span class="p">}</span><span class="o">,</span>
           <span class="p">{</span><span class="s2">&quot;distance&quot;</span><span class="o">:</span><span class="mf">130.21258</span><span class="o">,</span><span class="s2">&quot;lat&quot;</span><span class="o">:</span><span class="mf">45.523720</span><span class="o">,</span><span class="s2">&quot;lon&quot;</span><span class="o">:</span><span class="mf">-122.676545</span><span class="p">}</span>
          <span class="p">]</span>
        </pre>
        </div>
        <p> The <code>distance</code> attribute is the distance in feet from the queried 
          <code>lat</code>/<code>lon</code> pair to the respective result.</p>
      </td>
    </tr>
    <tr id='section-3'>
      <td class=docs>
        <div class="octowrap">
          <a class="octothorpe" href="#section-3">#</a>
          <h3>Developers</h3>
          <p>PDXAPI is powered by <a href="http://www.github.com/vmx/couchdb">GeoCouch</a>, a spatial index enabled flavor of CouchDB. This means that every piece of data in PDXAPI is accessible and editable through a REST-like interface, and that a revision history will be kept for each data point.</p> 
          <p>I am in the process of creating example client applications that take advantage of the full capabilities of the platform; the eye candy at the top of this page is just a teaser.</p>
          <p> Want to help out? Fork the project on <a href="http://github.com/maxogden/pdxapi">Github</a>
           or <a href="http://www.maxogden.com">contact me</a> if you are interested.</p>
          </div>
          
        </div>
      </td>
      <td class=code>
        <h3>Datasets</h3>
        <p> Datasets currently available through PDX API:</p>
        <p> 
          <pre>
          address_points_region
          bicycle_network
          bicycle_parking
          bridges
          business_association_boundaries
          capital_improvement_projects_line
          capital_improvement_projects_point
          capital_improvement_projects_poly
          city_boundaries
          city_halls_region
          corners
          county_boundaries
          county_boundaries_region
          curb_ramps
          curbs
          development_opportunity_areas
          elevation_map
          enterprise_and_e_commerce_zones
          fire_stations_region
          freight_districts
          freight_facilities
          garbage_hauler_boundaries
          guardrails
          heritage_trees
          home_buyer_opportunity_areas
          hospitals_region
          intermodal_facilities
          its_cameras_intelligent_transportation_system
          its_signs_intelligent_transportation_system
          leaf_pickup
          libraries_region
          light_rail
          light_rail_stops
          local_improvement_districts
          metro_council_districts
          neighborhood_associations
          neighborhood_associations_region
          parking_meters
          parks
          parks_easements
          parks_region
          parks_taxlots
          parks_trails
          parks_vegetation_survey
          pavement_maintained_not_maintained
          pavement_moratorium_streets
          pedestrian_districts
          schools_region
          sidewalks
          snow_ice_routes
          storefront_improvement_areas
          street_centerline_pdx
          street_centerlines
          street_sweeping_routes_day
          street_sweeping_routes_night
          streets_jobs_contract_jobs_line
          streets_jobs_contract_jobs_points
          streets_jobs_permit_jobs_line
          streets_jobs_permit_jobs_points
          streets_jobs_permit_jobs_polygon
          streets_local_improvement_district
          streets_region
          traffic_calming_devices
          traffic_signals
          transit_district_poly
          transit_stations
          trimet_bus_system_routes
          trimet_bus_system_stops
          trimet_park_and_ride_lots
          trimet_transit_centers
          tsp_classifications
          tsp_district_boundaries
          urban_renewal_areas
          vegetation
          watershed_sub_watershed_info
          wellhead_protection_area
          zip_codes
          zip_codes_region
          zoning_anno
          zoning_arrows
          zoning_lines
          zoning_region
          </pre>
        </p>
        <p> More to come soon!</p>
      </td>
    </tr>
    </table>
</div>
<script type="text/javascript">
  var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
  document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
  try {
  var pageTracker = _gat._getTracker("UA-15477568-1");
  pageTracker._trackPageview();
  } catch(err) {}
</script>
</body>
